- taskable ||= nil
- unless taskable
  - if grab_param(:work_task, :taskable_id) && grab_param(:work_task, :taskable_type)
    - taskable = BlobStruct.new :id => grab_param(:work_task, :taskable_id), :class => Kernel.const_get(grab_param(:work_task, :taskable_type))
- if taskable
  %h3 
    Tasks
    %span.actions= link_to image_tag('/images/fluxx_engine/theme/default/icons/add.png', :class=> 'add-button'), new_work_task_path(:work_task => {:taskable_type => taskable.class.name, :taskable_id => taskable.id}), :class => 'to-modal', 'data-on-success' => 'refreshNamed,close', 'target' => '.work-task-partial-span', :title => "add a task"
  - if !models || models.empty?
    There are no tasks.
  - else
    - models.sort_by{|task| task.created_at ? (-1 * task.created_at.to_i) : Time.at(0).to_i }.each do |model|
      %li.action-item
        %input{:type=>"checkbox", :class => 'as-put', 'data-on-success' => 'refreshCaller', :href => work_task_path(:id => model.id, :work_task => {:task_completed => !model.task_completed}), :checked => model.task_completed}
        = model.task_text
        %span.actions
          = link_to image_tag("/images/fluxx_engine/theme/default/icons/delete.png"), work_task_path(model), {:class => 'as-delete', 'data-on-success' => 'refreshCaller'}
<br>